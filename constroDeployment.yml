---
- name: Constro Deployment
  hosts: webservers
  remote_user: mayur
#  sudo: yes
  become_method: sudo
  become_user: vagrant


  tasks:
   - name: GIT PULL
     git:
       repo: git@github.com:woxiprogrammers/mco.git
       dest: chdir= /usr/share/nginx/html/share/mco
       accept_hostkey: yes
       update: yes
      # sudo_user: vagrant

   - name: execute php artisan migrate
     #command:  chdir= /usr/share/nginx/html/share/mco/
     command: chdir= /usr/share/nginx/html/share/mco 'php artisan migrate'

   - name: execute command for seeders
     command: chdir= /usr/share/nginx/html/share/mco/ php artisan db:seed #--class=UpdateBillStatusesTableSeeder

   - name: execute npm run production
     shell: chdir= /usr/share/nginx/html/share/mco/ sudo npm run production

   - name: execute clear cache
     command: chdir= /usr/share/nginx/html/share/mco/ php artisan cache:clear

   #- name: install composer
    # apt: name=composer state=present update_cache=yes
